<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

</head>
<body>
    
<table class="table">
  <thead>
    <tr>
      <th scope="col">Id</th>
      <th scope="col">Name</th>
      <th scope="col">Email</th>
      <th scope="col">IMage</th>
      <th scope="col">Password</th>
      <th scope="col">Action</th>
      
    </tr>
  </thead>
  <tbody id="tbody">
   
  </tbody>
</table>

<script>
  const baseUrl = "http://localhost:8080/allDatas"; // apna backend API URL

  async function loadData() {
    try {
      const response = await fetch(baseUrl);
      const data = await response.json();

      const tbody = document.getElementById("tbody");
      tbody.innerHTML = ""; // clear table

      data.forEach(user => {
        let tr = document.createElement("tr");

        tr.innerHTML = `
          <td>${user.id}</td>
          <td>${user.name}</td>
          <td>${user.email}</td>
         <td><img src="data:image/png;base64,${user.file}" width="60" height="60"/></td>
          <td>${user.password}</td>
          <td>
            <button class="btn btn-sm btn-warning" onclick="editUser(${user.id})">Edit</button>

            <button class="btn btn-sm btn-danger" onclick="deleteUser(${user.id})">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });

    } catch (error) {
      console.error("Error fetching data:", error);
    }
  }

  // Example edit and update

 function editUser(id) {
    // user id ko localStorage me save karke edit page par bhejna
    localStorage.setItem("editUserId", id);
    window.location.href = "edit.html";
}

  
// delete data

  const baseUrldelete = "http://localhost:8080/delete"; // apna backend API URL

  async function deleteUser(id) {
    if (confirm("Are you sure you want to delete this user?")) {
      try {
        const response = await fetch(`${baseUrldelete}/${id}`, {
          method: "DELETE"
        });

        if (response.ok) {
          alert("User deleted successfully ✅");
          loadData(); // table reload karo
        } else {
          alert("Failed to delete user ❌");
        }
      } catch (error) {
        console.error("Error while deleting:", error);
        alert("Error deleting user ❌");
      }
    }
  }
  

  // Load table on page load
  window.onload = loadData;
</script>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>
</body>
</html>